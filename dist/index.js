!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("XWatermark",[],e):"object"==typeof exports?exports.XWatermark=e():t.XWatermark=e()}(self,(function(){return function(){"use strict";var t={r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e);const n={id:"watermark",top:0,left:0,rows:0,cols:0,xSpace:50,ySpace:50,font:"Helvetica Neue, Arial, MS YaHei",weight:"normal",color:"black",fontsize:16,alpha:.1,angle:-15,zIndex:9999,width:"auto",height:"auto",mode:"n",parentNode:document.body,observer:!1,observerNode:null};function o(t,e){const n=document.getElementById(t),o=e||n?.parentNode||document.body;if(n){try{return o?.removeChild(n),!0}catch(t){}return!1}return!0}function i(t,e){t.font=`${e.weight} ${e.fontsize}px ${e.font}`,t.fillStyle=e.color,t.textAlign="left",t.textBaseline="bottom"}const a=(t,e)=>{const n=e.id||"watermark",a=e.parentNode||document.body;o(n,a);const s=1.5*e.fontsize;["stagger","s"].includes(e.mode)&&(e.xSpace*=2,e.ySpace*=2);const r=document.createElement("canvas"),l=r.getContext("2d");if(null===l)return"";if(i(l,e),"string"==typeof e.width){const n=Number(e.width);if(isNaN(n)){if("auto"!==e.width)return"";{const n=l.measureText(t);e.width=n.width+s*Math.sin(Math.abs(e.angle)*Math.PI/180)}}else e.width=n}if("string"==typeof e.height){const n=Number(e.height);if(isNaN(n)){if("auto"!==e.height)return"";{const n=((t,e,n)=>{const o=e.split("");let i="",a=0;for(let e=0;e<o.length;e++){const s=i+o[e];t.measureText(s).width>n&&e>0?(a++,i=o[e]):i=s}return++a})(l,t,e.width);e.height=s*n+e.width*Math.sin(Math.abs(e.angle)*Math.PI/180)}}else e.height=n}const d=window.devicePixelRatio||1;r.width=(e.width+e.xSpace)*d,r.height=(e.height+e.ySpace)*d,l.scale(d,d),i(l,e),function(t,e,n,o,i,a,s){t.save(),t.translate(n,o),t.rotate(s*Math.PI/180);const r=e.split("");let l="";const d=a*Math.sin(s*Math.PI/180);let c=s<0?-1:0;for(let e=0;e<r.length;e++){const n=l+r[e];t.measureText(n).width>i&&e>0?(t.fillText(l,d*c++,0),l=r[e],t.translate(0,a)):l=n}t.fillText(l,d*c,0),t.restore()}(l,t,0,(e.angle<0?1:0)*e.width*Math.sin(Math.abs(e.angle)*Math.PI/180)+.8*s,e.width,s,e.angle);const c=r.toDataURL("image/png");a===document.body||""!==a.style.position&&"static"!==a.style.position||(a.style.position="relative");const h=document.createElement("div");h.id=n,h.style.pointerEvents="none",h.style.overflow="hidden",h.style.top="0",h.style.left="0",h.style.position=a===document.body?"fixed":"absolute",h.style.zIndex=`${e.zIndex}`,h.style.opacity=`${e.alpha}`,h.style.paddingTop=`${e.top}px`,h.style.paddingLeft=`${e.left}px`,h.style.width=(a.clientWidth||document.documentElement.clientWidth)-e.left+"px",h.style.height=(a.clientHeight||document.documentElement.clientHeight)-e.top+"px";const u=document.createElement("div");switch(u.style.width="100%",u.style.height="100%",u.style.backgroundImage=`url(${c})`,u.style.backgroundPosition="0 0",e.mode){case"horizontal":case"h":case"x":u.style.backgroundRepeat="repeat-x";break;case"vertical":case"v":case"y":u.style.backgroundRepeat="repeat-y";break;case"stagger":case"s":u.style.backgroundImage=`url(${c}), url(${c})`,u.style.backgroundRepeat="repeat, repeat",u.style.backgroundPosition=`0 0, ${(e.width+e.xSpace)/2}px ${(e.height+e.ySpace)/2}px`;break;default:u.style.backgroundRepeat="repeat"}return u.style.backgroundSize=`${e.width+e.xSpace}px ${e.height+e.ySpace}px`,h.appendChild(u),a.appendChild(h),c};return e.default=class{base64="";content="";options=Object.assign({},n);constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t)return this.init(t,e)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=Object.assign({},n,e);const o=()=>{if(this.base64=a(t,this.options),this.content=t,this.options.observer){const t=window.MutationObserver||window.WebKitMutationObserver;if(t){const e=new t((t=>{t.forEach((t=>{"attributes"===t.type&&("clientWidth"!==t.attributeName&&"clientHeight"!==t.attributeName&&"style"!==t.attributeName||this.reload())}))})),n=this.options.observerNode||this.options.parentNode;e.observe(n,{attributes:!0})}}};return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o(),window.addEventListener("resize",o),this}reload(t,e){return e&&"object"==typeof e&&(this.options=Object.assign({},n,e)),this.remove(),this.init(t||this.content,this.options)}remove(){return o(this.options.id)}},e}()}));