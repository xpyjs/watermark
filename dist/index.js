!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("XWatermark",[],e):"object"==typeof exports?exports.XWatermark=e():t.XWatermark=e()}(self,(function(){return function(){"use strict";var t={r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e);const n={id:"watermark",top:0,left:0,rows:0,cols:0,xSpace:50,ySpace:50,font:"Helvetica Neue, Arial, MS YaHei",weight:"normal",color:"black",fontsize:16,alpha:.1,angle:-15,zIndex:9999,width:"auto",height:"auto",mode:"n",parentNode:document.body,observer:!1,observerNode:null};function o(t,e){const n=document.getElementById(t),o=e||n?.parentNode||document.body;if(n){try{return o?.removeChild(n),!0}catch(t){}return!1}return!0}function i(t,e){t.font=`${e.weight} ${e.fontsize}px ${e.font}`,t.fillStyle=e.color,t.textAlign="left",t.textBaseline="bottom"}const s=(t,e)=>{const n=e.id||"watermark",s=e.parentNode||document.body;o(n,s);const a=1.5*e.fontsize;let r=e.xSpace,l=e.ySpace;["stagger","s"].includes(e.mode)&&(r=2*e.xSpace,l=2*e.ySpace);const d=document.createElement("canvas"),c=d.getContext("2d");if(null===c)return"";if(i(c,e),"string"==typeof e.width){const n=Number(e.width);if(isNaN(n)){if("auto"!==e.width)return"";{const n=c.measureText(t);e.width=n.width+a*Math.sin(Math.abs(e.angle)*Math.PI/180)}}else e.width=n}if("string"==typeof e.height){const n=Number(e.height);if(isNaN(n)){if("auto"!==e.height)return"";{const n=((t,e,n)=>{const o=e.split("");let i="",s=0;for(let e=0;e<o.length;e++){const a=i+o[e];t.measureText(a).width>n&&e>0?(s++,i=o[e]):i=a}return++s})(c,t,e.width);e.height=a*n+e.width*Math.sin(Math.abs(e.angle)*Math.PI/180)}}else e.height=n}const h=window.devicePixelRatio||1;d.width=(e.width+r)*h,d.height=(e.height+l)*h,c.scale(h,h),i(c,e),function(t,e,n,o,i,s,a){t.save(),t.translate(n,o),t.rotate(a*Math.PI/180);const r=e.split("");let l="";const d=s*Math.sin(a*Math.PI/180);let c=a<0?-1:0;for(let e=0;e<r.length;e++){const n=l+r[e];t.measureText(n).width>i&&e>0?(t.fillText(l,d*c++,0),l=r[e],t.translate(0,s)):l=n}t.fillText(l,d*c,0),t.restore()}(c,t,0,(e.angle<0?1:0)*e.width*Math.sin(Math.abs(e.angle)*Math.PI/180)+.8*a,e.width,a,e.angle);const u=d.toDataURL("image/png");s===document.body||""!==s.style.position&&"static"!==s.style.position||(s.style.position="relative");const p=document.createElement("div");p.id=n,p.style.pointerEvents="none",p.style.overflow="hidden",p.style.top="0",p.style.left="0",p.style.position=s===document.body?"fixed":"absolute",p.style.zIndex=`${e.zIndex}`,p.style.opacity=`${e.alpha}`,p.style.paddingTop=`${e.top}px`,p.style.paddingLeft=`${e.left}px`,p.style.width=(s.clientWidth||document.documentElement.clientWidth)-e.left+"px",p.style.height=(s.clientHeight||document.documentElement.clientHeight)-e.top+"px";const g=document.createElement("div");switch(g.style.width="100%",g.style.height="100%",g.style.backgroundImage=`url(${u})`,g.style.backgroundPosition="0 0",e.mode){case"horizontal":case"h":case"x":g.style.backgroundRepeat="repeat-x";break;case"vertical":case"v":case"y":g.style.backgroundRepeat="repeat-y";break;case"stagger":case"s":g.style.backgroundImage=`url(${u}), url(${u})`,g.style.backgroundRepeat="repeat, repeat",g.style.backgroundPosition=`0 0, ${(e.width+r)/2}px ${(e.height+l)/2}px`;break;default:g.style.backgroundRepeat="repeat"}return g.style.backgroundSize=`${e.width+r}px ${e.height+l}px`,p.appendChild(g),s.appendChild(p),u};return e.default=class{base64="";content="";options=Object.assign({},n);constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t)return this.init(t,e)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=Object.assign({},n,e);const o=()=>{if(this.base64=s(t,this.options),this.content=t,this.options.observer){const t=window.MutationObserver||window.WebKitMutationObserver;if(t){const e=new t((t=>{t.forEach((t=>{"attributes"===t.type&&("clientWidth"!==t.attributeName&&"clientHeight"!==t.attributeName&&"style"!==t.attributeName||this.reload())}))})),n=this.options.observerNode||this.options.parentNode;e.observe(n,{attributes:!0})}}};return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o(),window.addEventListener("resize",o),this}reload(t,e){return e&&"object"==typeof e&&(this.options=Object.assign({},n,e)),this.remove(),this.init(t||this.content,this.options)}remove(){return o(this.options.id)}},e}()}));