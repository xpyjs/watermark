!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("XWatermark",[],e):"object"==typeof exports?exports.XWatermark=e():t.XWatermark=e()}(window,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function o(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.r(e);const i={id:"x-watermark",top:0,left:0,rows:0,cols:0,xSpace:50,ySpace:50,font:"Helvetica Neue, Arial, MS YaHei",weight:"normal",color:"black",fontsize:16,alpha:.1,angle:-15,zIndex:9999,width:"auto",height:"auto",mode:"n",parentNode:document.body,observer:!1,observerNode:null};function r(t,e){const n=document.getElementById(t),o=e||(null==n?void 0:n.parentNode)||document.body;if(n){try{return null==o||o.removeChild(n),!0}catch(t){}return!1}return!0}function a(t,e){t.font=`${e.weight} ${e.fontsize}px ${e.font}`,t.fillStyle=e.color,t.textAlign="left",t.textBaseline="bottom"}const s=(t,e)=>{const n=e.id||"watermark",o=e.parentNode||document.body;r(n,o);const i=1.5*e.fontsize;let s=e.xSpace,l=e.ySpace;["stagger","s"].includes(e.mode)&&(s=2*e.xSpace,l=2*e.ySpace);const c=document.createElement("canvas"),d=c.getContext("2d");if(null===d)return"";if(a(d,e),"string"==typeof e.width){const n=Number(e.width);if(isNaN(n)){if("auto"!==e.width)return"";{const n=d.measureText(t);e.width=n.width+i*Math.sin(Math.abs(e.angle)*Math.PI/180)}}else e.width=n}if("string"==typeof e.height){const n=Number(e.height);if(isNaN(n)){if("auto"!==e.height)return"";{const n=((t,e,n)=>{const o=e.split("");let i="",r=0;for(let e=0;e<o.length;e++){const a=i+o[e];t.measureText(a).width>n&&e>0?(r++,i=o[e]):i=a}return++r})(d,t,e.width);e.height=i*n+e.width*Math.sin(Math.abs(e.angle)*Math.PI/180)}}else e.height=n}const u=window.devicePixelRatio||1;c.width=(e.width+s)*u,c.height=(e.height+l)*u,d.scale(u,u),a(d,e),function(t,e,n,o,i,r,a){t.save(),t.translate(n,o),t.rotate(a*Math.PI/180);const s=e.split("");let l="";const c=r*Math.sin(a*Math.PI/180);let d=a<0?-1:0;for(let e=0;e<s.length;e++){const n=l+s[e];t.measureText(n).width>i&&e>0?(t.fillText(l,c*d++,0),l=s[e],t.translate(0,r)):l=n}t.fillText(l,c*d,0),t.restore()}(d,t,0,(e.angle<0?1:0)*e.width*Math.sin(Math.abs(e.angle)*Math.PI/180)+.8*i,e.width,i,e.angle);const h=c.toDataURL("image/png");o===document.body||""!==o.style.position&&"static"!==o.style.position||(o.style.position="relative");const p=document.createElement("div");p.id=n,p.style.pointerEvents="none",p.style.overflow="hidden",p.style.top="0",p.style.left="0",p.style.position=o===document.body?"fixed":"absolute",p.style.zIndex=`${e.zIndex}`,p.style.opacity=`${e.alpha}`,p.style.paddingTop=`${e.top}px`,p.style.paddingLeft=`${e.left}px`,p.style.width=(o.clientWidth||document.documentElement.clientWidth)-e.left+"px",p.style.height=(o.clientHeight||document.documentElement.clientHeight)-e.top+"px";const f=document.createElement("div");switch(f.style.width="100%",f.style.height="100%",f.style.backgroundImage=`url(${h})`,f.style.backgroundPosition="0 0",e.mode){case"horizontal":case"h":case"x":f.style.backgroundRepeat="repeat-x";break;case"vertical":case"v":case"y":f.style.backgroundRepeat="repeat-y";break;case"stagger":case"s":f.style.backgroundImage=`url(${h}), url(${h})`,f.style.backgroundRepeat="repeat, repeat",f.style.backgroundPosition=`0 0, ${(e.width+s)/2}px ${(e.height+l)/2}px`;break;default:f.style.backgroundRepeat="repeat"}return f.style.backgroundSize=`${e.width+s}px ${e.height+l}px`,p.appendChild(f),o.appendChild(p),h};e.default=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o(this,"base64",""),o(this,"content",""),o(this,"options",Object.assign({},i)),t)return this.init(t,e)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=Object.assign({},i,e);const n=()=>{if(this.base64=s(t,this.options),this.content=t,this.options.observer){const t=window.MutationObserver||window.WebKitMutationObserver;if(t){const e=new t((t=>{t.forEach((t=>{"attributes"===t.type&&("clientWidth"!==t.attributeName&&"clientHeight"!==t.attributeName&&"style"!==t.attributeName||this.reload())}))})),n=this.options.observerNode||this.options.parentNode;e.observe(n,{attributes:!0})}}};return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n(),window.addEventListener("resize",n),this}reload(t,e){return e&&"object"==typeof e&&(this.options=Object.assign({},i,e)),this.remove(),this.init(t||this.content,this.options)}remove(){return r(this.options.id)}}}])}));